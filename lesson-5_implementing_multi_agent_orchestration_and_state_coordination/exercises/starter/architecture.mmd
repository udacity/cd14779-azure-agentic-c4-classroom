graph TB
    User["ğŸ‘¤ Customer Request<br/>'I need 3 lattes for my team'"]

    subgraph Manager["ModernCoffeeShopSystem"]
        Kernel["Shared Kernel<br/>+ Azure OpenAI Service<br/>+ CoffeeShopPlugin"]
    end

    Coordinator["ğŸ”„ Shop Coordinator<br/>Routes to Specialist<br/>Analyzes Request"]

    subgraph Specialists["Specialist Agents with State Access"]
        Orders["ğŸ“‹ Order Manager<br/>Customer Service & Workflow"]
        Barista["ğŸ‘¨â€ğŸ³ Barista Manager<br/>Coffee Preparation & Equipment"]
        Inventory["ğŸ“¦ Inventory Manager<br/>Supply Chain & Restocking"]
    end

    subgraph State["CoffeeShopState (KernelBaseModel)"]
        OrdersDict["â˜• Orders Dict<br/>+ is_ready()<br/>+ get_order_details()"]
        Resources["ğŸ”§ Resources Dict<br/>+ is_available()<br/>+ get_resource_status()"]
        InventoryDict["ğŸ“¦ Inventory Dict<br/>Beans, Milk, Cups<br/>Stock Levels"]
    end

    Response["ğŸ“„ Specialist Response<br/>with Shop Analytics<br/>+ Workflow Coordination"]

    User -->|Shop Request| Manager
    Manager -->|Route| Coordinator

    Coordinator -->|Primary Agent| Orders
    Coordinator -.->|Or Route to| Barista
    Coordinator -.->|Or Route to| Inventory

    Orders <-->|Read/Write State| State
    Barista <-.->|Read/Write State| State
    Inventory <-.->|Read State| State

    State -->|State Data| OrdersDict
    State -->|State Data| Resources
    State -->|State Data| InventoryDict

    Orders -->|Response + Analytics| Response
    Barista -.->|Response + Analytics| Response
    Inventory -.->|Response + Analytics| Response

    Response -->|Display| User

    style User fill:#e1f5ff,stroke:#333,stroke-width:3px
    style Manager fill:#ffd700,stroke:#333,stroke-width:3px
    style Coordinator fill:#ffb366,stroke:#333,stroke-width:3px
    style Orders fill:#90ee90,stroke:#333,stroke-width:3px
    style Barista fill:#ffa8d5,stroke:#333,stroke-width:2px
    style Inventory fill:#ffa8d5,stroke:#333,stroke-width:2px
    style State fill:#d4edda,stroke:#333,stroke-width:4px
    style OrdersDict fill:#e8f5e9,stroke:#333,stroke-width:2px
    style Resources fill:#e8f5e9,stroke:#333,stroke-width:2px
    style InventoryDict fill:#e8f5e9,stroke:#333,stroke-width:2px
    style Response fill:#ffeb99,stroke:#333,stroke-width:3px