graph TB
    User["ðŸ‘¤ User Request<br/>'Show me inventory status and low stock books'"]

    subgraph Manager["BookStoreAgentManager"]
        Kernel["Shared Kernel<br/>+ Azure OpenAI Service<br/>+ StoreOperationsPlugin"]
    end

    Coordinator["ðŸ”„ Store Coordinator<br/>Routes to Specialist<br/>Analyzes Request"]

    subgraph Specialists["Specialist Agents with State Access"]
        Inventory["ðŸ“š Inventory Manager<br/>Stock Control & Analytics"]
        Sales["ðŸ’° Sales Manager<br/>Revenue & Customers"]
        Recommendations["ðŸŽ¯ Recommendation Engine<br/>Personalized Suggestions"]
    end

    subgraph State["StoreState (KernelBaseModel)"]
        Books["ðŸ“– Books Dict<br/>+ check_availability()<br/>+ get_book_info()"]
        Customers["ðŸ‘¥ Customers Dict<br/>+ check_vip_status()<br/>+ get_customer_profile()"]
        Orders["ðŸ›’ Orders Dict<br/>+ update_order_status()<br/>+ get_order_summary()"]
        Metrics["ðŸ“Š Store Metrics<br/>Balance, Revenue, Analytics"]
    end

    Response["ðŸ“„ Specialist Response<br/>with Current State Data<br/>+ ChatHistory Context"]

    User -->|Store Request| Manager
    Manager -->|Route| Coordinator

    Coordinator -->|Primary Agent| Inventory
    Coordinator -.->|Or Route to| Sales
    Coordinator -.->|Or Route to| Recommendations

    Inventory <-->|Read/Write State| State
    Sales <-.->|Read State| State
    Recommendations <-.->|Read State| State

    State -->|State Data| Books
    State -->|State Data| Customers
    State -->|State Data| Orders
    State -->|State Data| Metrics

    Inventory -->|Response + Analytics| Response
    Sales -.->|Response + Analytics| Response
    Recommendations -.->|Response + Analytics| Response

    Response -->|Display| User

    style User fill:#e1f5ff,stroke:#333,stroke-width:3px
    style Manager fill:#ffd700,stroke:#333,stroke-width:3px
    style Coordinator fill:#ffb366,stroke:#333,stroke-width:3px
    style Inventory fill:#90ee90,stroke:#333,stroke-width:3px
    style Sales fill:#ffa8d5,stroke:#333,stroke-width:2px
    style Recommendations fill:#ffa8d5,stroke:#333,stroke-width:2px
    style State fill:#d4edda,stroke:#333,stroke-width:4px
    style Books fill:#e8f5e9,stroke:#333,stroke-width:2px
    style Customers fill:#e8f5e9,stroke:#333,stroke-width:2px
    style Orders fill:#e8f5e9,stroke:#333,stroke-width:2px
    style Metrics fill:#e8f5e9,stroke:#333,stroke-width:2px
    style Response fill:#ffeb99,stroke:#333,stroke-width:3px